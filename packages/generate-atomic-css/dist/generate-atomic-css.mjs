/**
 * generate-atomic-css
 * Generate Atomic CSS
 * Version: 1.3.3
 * Author: Roy Revelt, Codsen Ltd
 * License: MIT
 * Homepage: https://codsen.com/os/generate-atomic-css/
 */

import{right as e,left as n,leftSeq as t,rightSeq as i}from"string-left-right";var l="1.3.3";function r(e){return"string"==typeof e}const s={CONFIGHEAD:"GENERATE-ATOMIC-CSS-CONFIG-STARTS",CONFIGTAIL:"GENERATE-ATOMIC-CSS-CONFIG-ENDS",CONTENTHEAD:"GENERATE-ATOMIC-CSS-CONTENT-STARTS",CONTENTTAIL:"GENERATE-ATOMIC-CSS-CONTENT-ENDS"},c=["px","em","%","rem","cm","mm","in","pt","pc","ex","ch","vw","vmin","vmax"],{CONFIGHEAD:u,CONFIGTAIL:f,CONTENTHEAD:g,CONTENTTAIL:d}=s,o=[":"];function h(e){return e.replace(new RegExp(`${/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/.source}$`,"g"),"")}function a(l){let s=l,c="",o="";if(l.includes(u)&&l.includes(f)){if(-1!==l.indexOf(f)&&-1!==l.indexOf(g)&&l.indexOf(f)>l.indexOf(g))throw new Error("generate-atomic-css: [THROW_ID_02] Config heads are after config tails!");let t=l.indexOf(u)+u.length,i=l.indexOf(f);if("*"===l[e(l,t)]&&"/"===l[e(l,e(l,t))]&&(t=e(l,e(l,t))+1),"*"===l[n(l,i)]&&"/"===l[n(l,n(l,i))]&&(i=n(l,n(l,i))),s=l.slice(t,i).trim(),!r(s)||!s.trim().length)return[s,c,o]}else if(l.includes(u)&&!l.includes(f)&&l.includes(g)){if(l.indexOf(u)>l.indexOf(g))throw new Error("generate-atomic-css: [THROW_ID_03] Config heads are after content heads!");s=l.slice(l.indexOf(u)+u.length,l.indexOf(g))}else if(l.includes(u)||l.includes(f)||!l.includes(g)&&!l.includes(d)){const e=new RegExp(`(\\/\\s*\\*\\s*)*${g}(\\s*\\*\\s*\\/)*`),n=new RegExp(`(\\/\\s*\\*\\s*)*${d}(\\s*\\*\\s*\\/)*`);let t=!1;const i=[],r=[],u=l.split("\n").filter((e=>!!t||(e.includes("$$$")||e.includes("{")||e.includes(":")?(t=!0,!0):(i.push(e),!1))));for(let e=u.length;e--&&!(u[e].includes("$$$")||u[e].includes("}")||u[e].includes(":"));)r.unshift(u.pop());s=u.join("\n").replace(e,"").replace(n,""),i.length&&(c=`${i.join("\n")}\n`),r.length&&(o=`\n${r.join("\n")}`)}else if(s=l,s.includes(g)){if(n(l,s.indexOf(g))){let e=s.indexOf(g);t(l,e,"/","*")&&(e=t(l,e,"/","*").leftmostChar),c=0===e?"":l.slice(0,e)}let r=s.indexOf(g)+g.length;i(s,r-1,"*","/")&&(r=i(s,r-1,"*","/").rightmostChar+1);let u=null;if(l.includes(d)){u=l.indexOf(d),"*"===l[n(l,u)]&&"/"===l[n(l,n(l,u))]&&(u=n(l,n(l,u)));let t=l.indexOf(d)+d.length;"*"===l[e(l,t-1)]&&"/"===l[e(l,e(l,t-1))]&&(t=e(l,e(l,t-1))+1),e(l,t)&&(o=l.slice(t))}s=u?s.slice(r,u).trim():s.slice(r).trim()}else if(s.includes(d)){const n=[];let i=!1;s=s.split("\n").filter((e=>e.includes("$$$")||i?(i||(i=!0),!0):(i||n.push(e),!1))).join("\n");let r,u=s.indexOf(d);t(s,u,"/","*")&&(u=t(s,u,"/","*").leftmostChar),s=s.slice(0,u).trim(),n.length&&(c=`${n.join("\n")}\n`),e(l,l.indexOf(d)+d.length)&&(r=l.indexOf(d)+d.length,"*"===l[e(l,r)]&&"/"===l[e(l,e(l,r))]&&(r=e(l,e(l,r))+1,e(l,r)&&(o=l.slice(r))))}return[s,c,o]}function O(e,n=0,t=500){let i,l=n,r=t,s=e;if(e.lastIndexOf("}")>0&&e.slice(e.lastIndexOf("}")+1).includes("|")?i=e.slice(e.lastIndexOf("}")+1).split("|").filter((e=>e.trim().length)).map((e=>e.trim())).filter((e=>String(e).split("").every((e=>/\d/g.test(e))))):e.includes("|")&&(i=e.split("|").filter((e=>e.trim().length)).map((e=>e.trim())).filter((e=>String(e).split("").every((e=>/\d/g.test(e)))))),Array.isArray(i)&&(1===i.length?r=Number.parseInt(i[0],10):i.length>1&&(l=Number.parseInt(i[0],10),r=Number.parseInt(i[1],10))),e.lastIndexOf("}")>0&&e.slice(e.lastIndexOf("}")+1).includes("|")){if(s=h(e.slice(0,e.indexOf("|",e.lastIndexOf("}")+1))),s.trim().startsWith("|"))for(;s.trim().startsWith("|");)s=s.trim().slice(1)}else{let n=null,t=!1,i=0,l=e.length,r=null;for(let s=0,c=e.length;s<c;s++)if("0123456789".includes(e[s])?null===r&&e[s].trim().length&&(r=!0):"|"!==e[s]&&e[s].trim().length&&(r=!1),!e[s+1]&&r&&n&&(l=n),"|"===e[s]){if(r&&n){l=n;break}n=s,r=null}else!t&&e[s].trim().length&&(t=!0,null!==n&&(i=n+1));s=h(e.slice(i,l))}return[l,r,s]}function $(n,t,i,l,s=!0,u,f){return function(e,n=!0){if(!n)return e;const t=Array.from(e);if(t.length&&r(t[0])&&!t[0].trim().length)do{t.shift()}while(r(t[0])&&!t[0].trim().length);if(t.length&&r(t[t.length-1])&&!t[t.length-1].trim().length)do{t.pop()}while(t&&t[t.length-1]&&!t[t.length-1].trim().length);return t}(n.split(/\r?\n/).map(((n,r,s)=>n.includes("$$$")?function(n,t,i,l,r,s){let u,f=0;const[g,d,h]=O(n,0,500),a=l-i;let $="";for(let n=g;n<=d;n++){let l=0,O=0;for(let t=0,i=h.length;t<i;t++){if(h[t].charCodeAt(0),"$"===h[t]&&"$"===h[t-1]&&"$"===h[t-2]){const i=h.slice(t+1);let r;if(0!==n||!c.some((e=>{if(i.startsWith(e))return r=e,!0}))||"{"!==h[e(h,t+r.length)]&&h[t+r.length+1].trim().length){let i;if(c.some((e=>{if(h.startsWith(e,t+1))return i=e,!0})),!h[t-3].trim().length||o.some((e=>h.slice(O,t-2).trim().endsWith(e)))){let e=0;0===n&&c.some((n=>(`${h.slice(O,t-2)}`.startsWith(n)&&(e=n.length),!0))),$+=`${h.slice(O+e,t-2)}${s?String(n).padStart(String(d).length+(0===n&&i?i.length:0)):n}`}else h[t+1].trim().length&&"{"!==h[e(h,t)]?($+=`${h.slice(O,t-2)}${n}`,s&&(l=String(d).length-String(n).length)):$+=`${h.slice(O,t-2)}${s?String(n).padEnd(String(d).length+(0===n&&i?i.length:0)):n}`;O=t+1}else $+=`${h.slice(O,t-2)}${s?String(n).padStart(String(d).length-String(n).length+r.length+1):n}`,O=t+1+(r?r.length:0)}if("{"===h[t]&&s&&l&&($+=`${h.slice(O,t)}${" ".repeat(l)}`,O=t,l=0),!h[t+1]){let e;const t=h.slice(O);0===n&&c.some((n=>{if(t.startsWith(n))return e=n,!0}))?$+=`${h.slice(O+e.length)}`:$+=`${h.slice(O)}`,$+=n!==d?"\n":""}}r.count+=1,"function"==typeof t&&(u=Math.floor(i+n/(d-g)*a),u!==f&&(f=u,t(u)))}return $}(n,t,i+(l-i)/s.length*r,i+(l-i)/s.length*(r+1),u,f):function(e,n){return/\.\w/g.test(e)&&(n.count+=1),e}(n,u))),s).join("\n")}const m={includeConfig:!0,includeHeadsAndTails:!0,pad:!0,configOverride:null,reportProgressFunc:null,reportProgressFuncFrom:0,reportProgressFuncTo:100};function p(t,i){if("string"!=typeof t)throw new Error(`generate-atomic-css: [THROW_ID_01] First input argument must be a string! It was given as "${JSON.stringify(t,null,4)}" (type ${typeof t})`);const{CONFIGHEAD:l,CONFIGTAIL:r,CONTENTHEAD:c,CONTENTTAIL:u}=s,f={count:0},g={...m,...i};if(g.includeConfig&&!g.includeHeadsAndTails&&(g.includeHeadsAndTails=!0),!g.configOverride&&!t.includes("$$$")&&!t.includes(l)&&!t.includes(r)&&!t.includes(c)&&!t.includes(u)||g&&g.configOverride&&"string"==typeof g.configOverride&&!g.configOverride.includes("$$$")&&!g.configOverride.includes(l)&&!g.configOverride.includes(r)&&!g.configOverride.includes(c)&&!g.configOverride.includes(u))return{log:{count:0},result:t};let d="",o="",[h,O,p]=a(g.configOverride?g.configOverride:t);if("string"!=typeof h||!h.trim())return{log:{count:0},result:""};if((g.includeConfig||g.includeHeadsAndTails)&&(d=`${c} */\n`,g.includeConfig||(d=`/* ${d}`),o=`\n/* ${u} */`),g.includeConfig&&(d=`/* ${l}\n${h.trim()}\n${r}\n${d}`),t.includes(l)&&null!=n(t,t.indexOf(l))){let i=t.indexOf(l);"*"===t[n(t,i)]&&"/"===t[n(t,n(t,i))]&&(i=n(t,n(t,i)));let r="/* ";("/"===t[e(t,i-1)]&&"*"===t[e(t,e(t,i-1))]||d.trim().startsWith("/*"))&&(r=""),d=`${t.slice(0,i)}${r}${d}`}if(t.includes(r)&&e(t,t.indexOf(r)+r.length)){let n=t.indexOf(r)+r.length;if("*"===t[e(t,t.indexOf(r)+r.length)]&&"/"===t[e(t,e(t,t.indexOf(r)+r.length))]&&(n=e(t,e(t,t.indexOf(r)+r.length))+1),t.slice(e(t,n-1)).startsWith(c)){n=e(t,n)||0+c.length,"*"===t[e(t,n-1)]&&"/"===t[e(t,e(t,n-1))]&&(n=e(t,e(t,n-1))+1),t.includes(u)&&(n=t.indexOf(u)+u.length,"*"===t[e(t,n)]&&"/"===t[e(t,e(t,n))]&&(n=e(t,e(t,n))+1))}const i=t.slice(n);i.length&&i.includes(u)&&(n=t.indexOf(u)+u.length,"*"===t[e(t,n)]&&"/"===t[e(t,e(t,n))]&&(n=e(t,e(t,n))+1)),o=`${o}${t[n]&&e(t,n-1)?t.slice(n):""}`}if("string"==typeof O&&(d=`${O}${d}`),"string"==typeof p){if(p.trim().endsWith("/*")&&!p.trim().startsWith("*/")){let n="";"string"==typeof p&&p[0]&&!p[0].trim()&&(n=p.slice(0,e(p,0)||0)),p=`${n}/* ${p.trim()}`}o=`${o}${p}`}const x=`${function(e,n={}){return n.includeConfig||n.includeHeadsAndTails?e.trim():e}(`${d}${$(h,g.reportProgressFunc,g.reportProgressFuncFrom,g.reportProgressFuncTo,!0,f,g.pad)}${o}`,g)}\n`;return{log:{count:f.count},result:x}}export{m as defaults,O as extractFromToSource,p as genAtomic,s as headsAndTails,l as version};
