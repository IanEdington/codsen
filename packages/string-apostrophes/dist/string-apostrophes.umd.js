/**
 * string-apostrophes
 * Comprehensive, HTML-entities-aware tool to typographically-correct the apostrophes and single/double quotes
 * Version: 1.2.27
 * Author: Roy Revelt, Codsen Ltd
 * License: MIT
 * Homepage: https://codsen.com/os/string-apostrophes/
 */

!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).stringApostrophes={})}(this,(function(e){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function n(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?n(Object(o),!0).forEach((function(r){t(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}function s(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"==typeof e)return i(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return i(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function u(e,r){if(!Array.isArray(e)||!e.length)return e;var t,n,s=o(o({},{strictlyTwoElementsInRangeArrays:!1,progressFn:null}),r);if(s.strictlyTwoElementsInRangeArrays&&!e.filter((function(e){return e})).every((function(e,r){return 2===e.length||(t=r,n=e.length,!1)})))throw new TypeError("ranges-sort: [THROW_ID_03] The first argument should be an array and must consist of arrays which are natural number indexes representing TWO string index ranges. However, ".concat(t,"th range (").concat(JSON.stringify(e[t],null,4),") has not two but ").concat(n," elements!"));if(!e.filter((function(e){return e})).every((function(e,r){return!(!Number.isInteger(e[0])||e[0]<0||!Number.isInteger(e[1])||e[1]<0)||(t=r,!1)})))throw new TypeError("ranges-sort: [THROW_ID_04] The first argument should be an array and must consist of arrays which are natural number indexes representing string index ranges. However, ".concat(t,"th range (").concat(JSON.stringify(e[t],null,4),") does not consist of only natural numbers!"));var i=Math.pow(e.filter((function(e){return e})).length,2),u=0;return Array.from(e).filter((function(e){return e})).sort((function(e,r){return s.progressFn&&(u+=1,s.progressFn(Math.floor(100*u/i))),e[0]===r[0]?e[1]<r[1]?-1:e[1]>r[1]?1:0:e[0]<r[0]?-1:1}))}function a(e,t){function n(e){return"string"==typeof e}function i(e){return e&&"object"===r(e)&&!Array.isArray(e)}if(!Array.isArray(e)||!e.length)return null;var a,c={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};if(t){if(!i(t))throw new Error("emlint: [THROW_ID_03] the second input argument must be a plain object. It was given as:\n".concat(JSON.stringify(t,null,4)," (type ").concat(r(t),")"));if((a=o(o({},c),t)).progressFn&&i(a.progressFn)&&!Object.keys(a.progressFn).length)a.progressFn=null;else if(a.progressFn&&"function"!=typeof a.progressFn)throw new Error('ranges-merge: [THROW_ID_01] opts.progressFn must be a function! It was given of a type: "'.concat(r(a.progressFn),'", equal to ').concat(JSON.stringify(a.progressFn,null,4)));if(a.mergeType&&1!==a.mergeType&&2!==a.mergeType)if(n(a.mergeType)&&"1"===a.mergeType.trim())a.mergeType=1;else{if(!n(a.mergeType)||"2"!==a.mergeType.trim())throw new Error('ranges-merge: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "'.concat(r(a.mergeType),'", equal to ').concat(JSON.stringify(a.mergeType,null,4)));a.mergeType=2}if("boolean"!=typeof a.joinRangesThatTouchEdges)throw new Error('ranges-merge: [THROW_ID_04] opts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "'.concat(r(a.joinRangesThatTouchEdges),'", equal to ').concat(JSON.stringify(a.joinRangesThatTouchEdges,null,4)))}else a=o({},c);for(var l,p,f,g=e.filter((function(e){return e})).map((function(e){return s(e)})).filter((function(e){return void 0!==e[2]||e[0]!==e[1]})),h=(l=a.progressFn?u(g,{progressFn:function(e){(f=Math.floor(e/5))!==p&&(p=f,a.progressFn(f))}}):u(g)).length-1,y=h;y>0;y--)a.progressFn&&(f=Math.floor(78*(1-y/h))+21)!==p&&f>p&&(p=f,a.progressFn(f)),(l[y][0]<=l[y-1][0]||!a.joinRangesThatTouchEdges&&l[y][0]<l[y-1][1]||a.joinRangesThatTouchEdges&&l[y][0]<=l[y-1][1])&&(l[y-1][0]=Math.min(l[y][0],l[y-1][0]),l[y-1][1]=Math.max(l[y][1],l[y-1][1]),void 0!==l[y][2]&&(l[y-1][0]>=l[y][0]||l[y-1][1]<=l[y][1])&&null!==l[y-1][2]&&(null===l[y][2]&&null!==l[y-1][2]?l[y-1][2]=null:void 0!==l[y-1][2]?2===a.mergeType&&l[y-1][0]===l[y][0]?l[y-1][2]=l[y][2]:l[y-1][2]+=l[y][2]:l[y-1][2]=l[y][2]),l.splice(y,1),y=l.length);return l.length?l:null}function c(e){return null!=e}function l(e){return"string"==typeof e}function p(e,t,n){var o,s=0,i=0;if(0===arguments.length)throw new Error("ranges-apply: [THROW_ID_01] inputs missing!");if(!l(e))throw new TypeError("ranges-apply: [THROW_ID_02] first input argument must be a string! Currently it's: ".concat(r(e),", equal to: ").concat(JSON.stringify(e,null,4)));if(t&&!Array.isArray(t))throw new TypeError("ranges-apply: [THROW_ID_03] second input argument must be an array (or null)! Currently it's: ".concat(r(t),", equal to: ").concat(JSON.stringify(t,null,4)));if(n&&"function"!=typeof n)throw new TypeError("ranges-apply: [THROW_ID_04] the third input argument must be a function (or falsey)! Currently it's: ".concat(r(n),", equal to: ").concat(JSON.stringify(n,null,4)));if(!t||!t.filter((function(e){return e})).length)return e;var u=(o=Array.isArray(t)&&(Number.isInteger(t[0])&&t[0]>=0||/^\d*$/.test(t[0]))&&(Number.isInteger(t[1])&&t[1]>=0||/^\d*$/.test(t[1]))?[Array.from(t)]:Array.from(t)).length,p=0;o.filter((function(e){return e})).forEach((function(e,t){if(n&&(s=Math.floor(p/u*10))!==i&&(i=s,n(s)),!Array.isArray(e))throw new TypeError("ranges-apply: [THROW_ID_05] ranges array, second input arg., has ".concat(t,"th element not an array: ").concat(JSON.stringify(e,null,4),", which is ").concat(r(e)));if(!Number.isInteger(e[0])||e[0]<0){if(!/^\d*$/.test(e[0]))throw new TypeError("ranges-apply: [THROW_ID_06] ranges array, second input arg. has ".concat(t,"th element, array [").concat(e[0],",").concat(e[1],"]. That array has first element not an integer, but ").concat(r(e[0]),", equal to: ").concat(JSON.stringify(e[0],null,4),". Computer doesn't like this."));o[t][0]=Number.parseInt(o[t][0],10)}if(!Number.isInteger(e[1])){if(!/^\d*$/.test(e[1]))throw new TypeError("ranges-apply: [THROW_ID_07] ranges array, second input arg. has ".concat(t,"th element, array [").concat(e[0],",").concat(e[1],"]. That array has second element not an integer, but ").concat(r(e[1]),", equal to: ").concat(JSON.stringify(e[1],null,4),". Computer doesn't like this."));o[t][1]=Number.parseInt(o[t][1],10)}p+=1}));var f=a(o,{progressFn:function(e){n&&(s=10+Math.floor(e/10))!==i&&(i=s,n(s))}});if(!f)return e;var g=f.length;if(g>0){var h=e.slice(f[g-1][1]);e=f.reduce((function(r,t,o,u){n&&(s=20+Math.floor(o/g*80))!==i&&(i=s,n(s));var a=0===o?0:u[o-1][1],l=u[o][0];return r+e.slice(a,l)+(c(u[o][2])?u[o][2]:"")}),""),e+=h}return e}function f(e,r){var t=r.from,n=r.to,o=r.value,s=r.convertEntities,i=void 0===s||s,u=r.convertApostrophes,a=void 0===u||u,c=r.offsetBy;if(!Number.isInteger(n)){if(!Number.isInteger(t))throw new Error('string-apostrophes: [THROW_ID_01] options objects keys\' "to" and "from" values are not integers!');n=t+1}var l=[],p="‘",f="’",g="“",h="”",y="′",m="″",d=[".",",",";","!","?"];function w(e){return"string"==typeof e&&e.charCodeAt(0)>=48&&e.charCodeAt(0)<=57}function q(e){return"string"==typeof e&&e.length&&e.toUpperCase()!==e.toLowerCase()}return["'",p,f,y].includes(o)||n===t+1&&["'",p,f,y].includes(e[t])?e[t-1]&&e[n]&&w(e[t-1])&&!q(e[n])?a&&e.slice(t,n)!==(i?"&prime;":y)&&o!==(i?"&prime;":y)?l.push([t,n,i?"&prime;":y]):a||"'"===e.slice(t,n)||"'"===o||l.push([t,n,"'"]):e[n]&&e[n+1]&&"n"===e[n]&&e.slice(t,n)===e.slice(n+1,n+1+(n-t))?a&&e.slice(t,n+2)!==(i?"&rsquo;n&rsquo;":"".concat(f,"n").concat(f))&&o!==(i?"&rsquo;n&rsquo;":"".concat(f,"n").concat(f))?(l.push([t,n+2,i?"&rsquo;n&rsquo;":"".concat(f,"n").concat(f)]),"function"==typeof c&&c(2)):a||"'n'"===e.slice(t,n+2)||"'n'"===o||(l.push([t,n+2,"'n'"]),"function"==typeof c&&c(2)):e[n]&&"t"===e[n].toLowerCase()&&(!e[n+1]||!e[n+1].trim()||"i"===e[n+1].toLowerCase())||e[n]&&e[n+2]&&"t"===e[n].toLowerCase()&&"w"===e[n+1].toLowerCase()&&("a"===e[n+2].toLowerCase()||"e"===e[n+2].toLowerCase()||"i"===e[n+2].toLowerCase()||"o"===e[n+2].toLowerCase())||e[n]&&e[n+1]&&"e"===e[n].toLowerCase()&&"m"===e[n+1].toLowerCase()||e[n]&&e[n+4]&&"c"===e[n].toLowerCase()&&"a"===e[n+1].toLowerCase()&&"u"===e[n+2].toLowerCase()&&"s"===e[n+3].toLowerCase()&&"e"===e[n+4].toLowerCase()||e[n]&&w(e[n])?a&&e.slice(t,n)!==(i?"&rsquo;":f)&&o!==(i?"&rsquo;":f)?l.push([t,n,i?"&rsquo;":f]):a||"'"===e.slice(t,n)||"'"===o||l.push([t,n,"'"]):e[t-1]&&e[n]&&d.includes(e[t-1])?e[n].trim()?'"'===e[n]&&e[n+1]&&!e[n+1].trim()&&(a&&e.slice(t,n+1)!==(i?"&rsquo;&rdquo;":"".concat(f).concat(h))&&o!==(i?"&rsquo;&rdquo;":"".concat(f).concat(h))?(l.push([t,n+1,"".concat(i?"&rsquo;&rdquo;":"".concat(f).concat(h))]),"function"==typeof c&&c(1)):a||"'\""===e.slice(t,n+1)||"'\""===o||(l.push([t,n+1,"'\""]),"function"==typeof c&&c(1))):a&&e.slice(t,n)!==(i?"&rsquo;":f)&&o!==(i?"&rsquo;":f)?l.push([t,n,i?"&rsquo;":f]):a||"'"===e.slice(t,n)||"'"===o||l.push([t,n,"'"]):0===t&&e.slice(n).trim()?a&&e.slice(t,n)!==(i?"&lsquo;":p)&&o!==(i?"&lsquo;":p)?l.push([t,n,i?"&lsquo;":p]):a||"'"===e.slice(t,n)||"'"===o||l.push([t,n,"'"]):!e[n]&&e.slice(0,t).trim()?a&&e.slice(t,n)!==(i?"&rsquo;":f)&&o!==(i?"&rsquo;":f)?l.push([t,n,i?"&rsquo;":f]):a||"'"===e.slice(t,n)||"'"===o||l.push([t,n,"'"]):e[t-1]&&e[n]&&(q(e[t-1])||w(e[t-1]))&&(q(e[n])||w(e[n]))?a?(e[n]&&e[t-5]&&"h"===e[t-5].toLowerCase()&&"a"===e[t-4].toLowerCase()&&"w"===e[t-3].toLowerCase()&&"a"===e[t-2].toLowerCase()&&"i"===e[t-1].toLowerCase()&&"i"===e[n].toLowerCase()||e[t-1]&&"o"===e[t-1].toLowerCase()&&e[n+2]&&"a"===e[n].toLowerCase()&&"h"===e[n+1].toLowerCase()&&"u"===e[n+2].toLowerCase())&&e.slice(t,n)!==(i?"&lsquo;":p)&&o!==(i?"&lsquo;":p)?l.push([t,n,i?"&lsquo;":p]):e.slice(t,n)!==(i?"&rsquo;":f)&&o!==(i?"&rsquo;":f)&&l.push([t,n,i?"&rsquo;":f]):"'"!==e.slice(t,n)&&"'"!==o&&l.push([t,n,"'"]):e[n]&&(q(e[n])||w(e[n]))?a&&e.slice(t,n)!==(i?"&lsquo;":p)&&o!==(i?"&lsquo;":p)?l.push([t,n,i?"&lsquo;":p]):a||"'"===e.slice(t,n)||"'"===o||l.push([t,n,"'"]):q(e[t-1])||w(e[t-1])?a&&e.slice(t,n)!==(i?"&rsquo;":f)&&o!==(i?"&rsquo;":f)?l.push([t,n,i?"&rsquo;":f]):a||"'"===e.slice(t,n)||"'"===o||l.push([t,n,"'"]):e[t-1]&&!e[t-1].trim()?a&&e.slice(t,n)!==(i?"&lsquo;":p)&&o!==(i?"&lsquo;":p)?l.push([t,n,i?"&lsquo;":p]):a||"'"===e.slice(t,n)||"'"===o||l.push([t,n,"'"]):e[n]&&!e[n].trim()&&(a&&e.slice(t,n)!==(i?"&rsquo;":f)&&o!==(i?"&rsquo;":f)?l.push([t,n,i?"&rsquo;":f]):a||"'"===e.slice(t,n)||"'"===o||l.push([t,n,"'"])):(['"',g,h,m].includes(o)||n===t+1&&['"',g,h,m].includes(e[t]))&&(e[t-1]&&w(e[t-1])&&e[n]&&"'"!==e[n]&&'"'!==e[n]&&e[n]!==f&&e[n]!==h&&e[n]!==p&&e[n]!==g?a&&e.slice(t,n)!==(i?"&Prime;":m)&&o!==(i?"&Prime;":m)?l.push([t,n,i?"&Prime;":m]):a||'"'===e.slice(t,n)||'"'===o||l.push([t,n,'"']):e[t-1]&&e[n]&&d.includes(e[t-1])?e[n].trim()?"'"===e[n]&&e[n+1]&&!e[n+1].trim()&&(a&&e.slice(t,n+1)!==(i?"&rdquo;&rsquo;":"".concat(h).concat(f))&&o!==(i?"&rdquo;&rsquo;":"".concat(h).concat(f))?(l.push([t,n+1,i?"&rdquo;&rsquo;":"".concat(h).concat(f)]),"function"==typeof c&&c(1)):a||"\"'"===e.slice(t,n+1)||"\"'"===o||(l.push([t,n+1,"\"'"]),"function"==typeof c&&c(1))):a&&e.slice(t,n)!==(i?"&rdquo;":h)&&o!==(i?"&rdquo;":h)?l.push([t,n,i?"&rdquo;":h]):a||'"'===e.slice(t,n)||'"'===o||l.push([t,n,'"']):0===t&&e[n]&&e.slice(n).trim()?a&&e.slice(t,n)!==(i?"&ldquo;":g)&&o!==(i?"&ldquo;":g)?l.push([t,n,i?"&ldquo;":g]):a||'"'===e.slice(t,n)||'"'===o||l.push([t,n,'"']):!e[n]&&e.slice(0,t).trim()?a&&e.slice(t,n)!==(i?"&rdquo;":h)&&o!==(i?"&rdquo;":h)?l.push([t,n,i?"&rdquo;":h]):a||'"'===e.slice(t,n)||'"'===o||l.push([t,n,'"']):e[n]&&(q(e[n])||w(e[n]))?a&&e.slice(t,n)!==(i?"&ldquo;":g)&&o!==(i?"&ldquo;":g)?l.push([t,n,i?"&ldquo;":g]):a||'"'===e.slice(t,n)||'"'===o||l.push([t,n,'"']):e[t-1]&&(q(e[t-1])||w(e[t-1]))?a&&e.slice(t,n)!==(i?"&rdquo;":h)&&o!==(i?"&rdquo;":h)?l.push([t,n,i?"&rdquo;":h]):a||'"'===e.slice(t,n)||'"'===o||l.push([t,n,'"']):e[t-1]&&!e[t-1].trim()?a&&e.slice(t,n)!==(i?"&ldquo;":g)&&o!==(i?"&ldquo;":g)?l.push([t,n,i?"&ldquo;":g]):a||'"'===e.slice(t,n)||'"'===o||l.push([t,n,'"']):e[n]&&!e[n].trim()&&(a&&e.slice(t,n)!==(i?"&rdquo;":h)&&o!==(i?"&rdquo;":h)?l.push([t,n,i?"&rdquo;":h]):a||'"'===e.slice(t,n)||'"'===o||l.push([t,n,'"']))),l}e.convertAll=function(e,r){for(var t=[],n=o({convertApostrophes:!0,convertEntities:!1},r),s=0,i=e.length;s<i;s++){n.from=s,n.offsetBy=function(e){s+=e};var u=f(e,n);Array.isArray(u)&&u.length&&(t=t.concat(u))}return{result:p(e,t),ranges:t}},e.convertOne=f,Object.defineProperty(e,"__esModule",{value:!0})}));
