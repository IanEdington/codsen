/**
 * is-media-descriptor
 * Is given string a valid media descriptor (including media query)?
 * Version: 1.1.0
 * Author: Roy Revelt, Codsen Ltd
 * License: MIT
 * Homepage: https://gitlab.com/codsen/codsen/tree/master/packages/is-media-descriptor
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).isMediaDescriptor=t()}(this,(function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var o=[],n=!0,r=!1,i=void 0;try{for(var f,s=e[Symbol.iterator]();!(n=(f=s.next()).done)&&(o.push(f.value),!t||o.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return o}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}const o=[],n=[],r=(e,t)=>{if(e===t)return 0;const r=e;e.length>t.length&&(e=t,t=r);let i=e.length,f=t.length;for(;i>0&&e.charCodeAt(~-i)===t.charCodeAt(~-f);)i--,f--;let s,l,a,u,c=0;for(;c<i&&e.charCodeAt(c)===t.charCodeAt(c);)c++;if(i-=c,f-=c,0===i)return f;let d=0,h=0;for(;d<i;)n[d]=e.charCodeAt(c+d),o[d]=++d;for(;h<f;)for(s=t.charCodeAt(c+h),a=h++,l=h,d=0;d<i;d++)u=s===n[d]?a:a+1,a=o[d],l=o[d]=a>l?u>l?l+1:u:u>a?a+1:u;return l};var i=r,f=r;i.default=f;var s=["all","aural","braille","embossed","handheld","print","projection","screen","speech","tty","tv"];return function(o,n){var r=Object.assign({},{offset:0},n);if(r.offset&&!Number.isInteger(r.offset))throw new Error("is-media-descriptor: [THROW_ID_01] opts.offset must be an integer, it was given as ".concat(r.offset," (type ").concat(e(r.offset),")"));if(r.offset||(r.offset=0),"string"!=typeof o)return[];if(!o.trim().length)return[];var f=[],l=0,a=o.length,u=o.trim();if(o!==o.trim()){var c=[];if(!o[0].trim().length)for(var d=0,h=o.length;d<h;d++)if(o[d].trim().length){c.push([0+r.offset,d+r.offset]),l=d;break}if(!o[o.length-1].trim().length)for(var m=o.length;m--;)if(o[m].trim().length){c.push([m+1+r.offset,o.length+r.offset]),a=m+1;break}f.push({idxFrom:c[0][0],idxTo:c[c.length-1][1],message:"Remove whitespace.",fix:{ranges:c}})}if(s.includes(u))return f;if(["only","not"].includes(u))f.push({idxFrom:l+r.offset,idxTo:a+r.offset,message:"Missing media type or condition.",fix:null});else if(!u.match(/^\w+$/g)||u.includes("(")||u.includes(")")){var g=!1,p=t(Array.from(u).reduce((function(e,t){return")"===t?(!g&&e[1]+1>e[0]&&(g=!0),[e[0],e[1]+1]):"("===t?[e[0]+1,e[1]]:e}),[0,0]),2),y=p[0],x=p[1];if(g&&y===x&&f.push({idxFrom:l+r.offset,idxTo:a+r.offset,message:"Some closing brackets are before their opening counterparts.",fix:null}),y>x?f.push({idxFrom:l+r.offset,idxTo:a+r.offset,message:"More opening brackets than closing.",fix:null}):x>y&&f.push({idxFrom:l+r.offset,idxTo:a+r.offset,message:"More closing brackets than opening.",fix:null}),f.length)return f;for(var b=null,v=!0,T=[],w=0,F=u.length;w<=F;w++){if(!(null===b||u[w]&&u[w].trim().length)){var k=u.slice(b,w);if(T.push(k),v)if(k.startsWith("("));else if(["only","not"].includes(k.toLowerCase())){if(T.length>1&&["only","not"].includes(T[T.length-1])){f.push({idxFrom:b+r.offset,idxTo:w+r.offset,message:'"'.concat(k,'" instead of a media type.'),fix:null});break}}else if(["and"].includes(k.toLowerCase())){if(T.length>1&&["only","not"].includes(T[T.length-2])){f.push({idxFrom:b+r.offset,idxTo:w+r.offset,message:'"'.concat(k,'" instead of a media type.'),fix:null});break}}else{if(!s.includes(k.toLowerCase())){f.push({idxFrom:b+r.offset,idxTo:w+r.offset,message:'Unrecognised media type "'.concat(u.slice(b,w),'".'),fix:null});break}v=!1}else{if("and"!==k){f.push({idxFrom:b+r.offset,idxTo:w+r.offset,message:'Unrecognised media type "'.concat(u.slice(b,w),'".'),fix:null});break}v=!0}b=null}null===b&&u[w]&&u[w].trim().length&&(b=w)}}else for(var A=0,C=s.length;A<C;A++){if(1===i(s[A],u)){f.push({idxFrom:l+r.offset,idxTo:a+r.offset,message:'Did you mean "'.concat(s[A],'"?'),fix:{ranges:[[l+r.offset,a+r.offset,s[A]]]}});break}A===C-1&&f.push({idxFrom:l+r.offset,idxTo:a+r.offset,message:'Unrecognised media type "'.concat(u,'".'),fix:null})}return f}}));
